(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d08723d4"],{"0ac8":function(t,e,n){},"0bad":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"location"},[n("div",{staticClass:"location__header"},[n("div",{staticClass:"location__row"},[n("span",[t._v(t._s(t.$t("orderPage.location.city")))]),n("base-autocomplete",{attrs:{list:t.cityList,placeholder:t.$t("orderPage.location.cityPlaceholder")},model:{value:t.location,callback:function(e){t.location=e},expression:"location"}})],1),n("div",{staticClass:"location__row"},[n("span",[t._v(t._s(t.$t("orderPage.location.pickUpPoint")))]),n("base-autocomplete",{attrs:{list:t.pointList,isLoading:t.isPointListLoading,placeholder:t.$t("orderPage.location.pickUpPointPlaceholder")},model:{value:t.point,callback:function(e){t.point=e},expression:"point"}})],1)]),n("div",{staticClass:"location__map"},[n("span",{staticClass:"location__map-title"},[t._v(t._s(t.$t("orderPage.location.mapTitle"))+":")]),n("div",{staticClass:"location__map-wrapper"},[n("the-map",{attrs:{city:t.location,"point-list":t.pointList},on:{select:function(e){t.point=e}}})],1)])])},i=[],r=n("5530"),a=n("2f62"),s=n("3800"),c=n("c5c1"),l=n("fb3e"),u=n("efc3"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{height:"400px",width:"auto"},attrs:{id:"map"}})},d=[],m=n("2909"),f=n("1da1"),h=(n("96cf"),n("b0c0"),n("d81d"),n("99af"),n("d3b7"),n("3ca3"),n("ddb0"),{name:"TheMap",props:{city:{type:[Object,String],required:!0},pointList:{type:Array,default:function(){return[]},validator:function(t){return t.every((function(t){return t.hasOwnProperty("address")&&"string"===typeof(null===t||void 0===t?void 0:t.address)}))}}},data:function(){return{map:null}},watch:{city:{handler:function(t){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.getCityCoordinates(t.name);case 2:o=n.sent,e.map.setCenter(o),e.map.geoObjects.removeAll();case 5:case"end":return n.stop()}}),n)})))()}},pointList:function(){this.setAllPoints()}},methods:{addPoint:function(t){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function o(){var i,r,a;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i="".concat(e.city.name,", ").concat(t.address),o.next=3,ymaps.geocode(i,{results:1});case 3:r=o.sent,a=r.geoObjects.get(0),a.options.set("iconImageHref",n("fb12")),a.options.set("iconLayout","default#image"),a.events.add("click",(function(){e.$emit("select",t)})),e.map.geoObjects.add(a);case 9:case"end":return o.stop()}}),o)})))()},setAllPoints:function(){var t=this;if(this.pointList&&this.pointList.length){var e=Object(m["a"])(this.pointList);if(e&&e.length&&this.map){var n=e.map((function(e){return t.addPoint(e)}));Promise.all(n).then((function(){return t.fitMapSize()}))}}},fitMapSize:function(){var t=this.map.geoObjects.getBounds();this.map.setBounds(t,{zoomMargin:100}),this.map.setZoom(11,{duration:500})},getCityCoordinates:function(t){return Object(f["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ymaps.geocode(t,{results:1});case 2:return n=e.sent,o=n.geoObjects.get(0),e.abrupt("return",o.geometry._coordinates);case 5:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this;ymaps.ready(Object(f["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getCityCoordinates(t.city.name);case 2:n=e.sent,t.map=new ymaps.Map("map",{center:n,zoom:11}),t.map.controls.remove("fullscreenControl"),t.map.controls.remove("routeEditor"),t.map.controls.remove("rulerControl"),t.map.controls.remove("searchControl"),t.map.controls.remove("trafficControl"),t.map.controls.remove("typeSelector"),t.setAllPoints();case 11:case"end":return e.stop()}}),e)}))))},beforeDestroy:function(){this.map.destroy()}}),g=h,v=(n("f195"),n("2877")),b=Object(v["a"])(g,p,d,!1,null,null,null),y=b.exports,w={name:"OrderLocation",components:{TheMap:y},computed:Object(r["a"])(Object(r["a"])({},Object(a["c"])({cityList:c["c"].allCities,pointList:l["c"].allPoints,isPointListLoading:l["c"].isLoading,isPointListEmpty:l["c"].isEmpty})),{},{location:{get:function(){return this.$store.getters[s["b"].location]},set:function(t){this.$store.commit(s["c"].setLocation,t)}},point:{get:function(){return this.$store.getters[u["b"].point]},set:function(t){this.$store.commit(u["c"].setPoint,t)}}}),watch:{location:{immediate:!0,handler:function(t){if(t){var e=t.id;this.fetchPointList({cityId:e}),this.point=""}}}},methods:Object(r["a"])({},Object(a["b"])({fetchPointList:l["a"].getPointListByCityId}))},P=w,L=(n("9319"),Object(v["a"])(P,o,i,!1,null,"0d7a9f38",null));e["default"]=L.exports},4459:function(t,e,n){},9319:function(t,e,n){"use strict";n("0ac8")},"99af":function(t,e,n){"use strict";var o=n("23e7"),i=n("d039"),r=n("e8b5"),a=n("861d"),s=n("7b0b"),c=n("50c4"),l=n("8418"),u=n("65f0"),p=n("1dde"),d=n("b622"),m=n("2d00"),f=d("isConcatSpreadable"),h=9007199254740991,g="Maximum allowed index exceeded",v=m>=51||!i((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),b=p("concat"),y=function(t){if(!a(t))return!1;var e=t[f];return void 0!==e?!!e:r(t)},w=!v||!b;o({target:"Array",proto:!0,forced:w},{concat:function(t){var e,n,o,i,r,a=s(this),p=u(a,0),d=0;for(e=-1,o=arguments.length;e<o;e++)if(r=-1===e?a:arguments[e],y(r)){if(i=c(r.length),d+i>h)throw TypeError(g);for(n=0;n<i;n++,d++)n in r&&l(p,d,r[n])}else{if(d>=h)throw TypeError(g);l(p,d++,r)}return p.length=d,p}})},f195:function(t,e,n){"use strict";n("4459")}}]);
//# sourceMappingURL=chunk-d08723d4.4f7eae63.js.map